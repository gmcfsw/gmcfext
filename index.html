<!DOCTYPE html>
<html lang="ko">

<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.css" />
<style>
    /* Target all <svg> elements and set their width and height */
    svg {
      width: 100px; /* Set your desired width */
      height: 100px; /* Set your desired height */
    }
  </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.js"></script>
<script src="https://apis.google.com/js/platform.js" async defer></script>
<meta name="google-signin-client_id" content="559859685690-vpt1u03eg2su86qm475358tn4parjama.apps.googleusercontent.com">
<!--<script src="viewer.js"></script>-->
<script>
	const SPREADSHEET_ID = '1JzsKbWb0ei8-gmjVi14WKX8XihlPiOymBaFG0dhD9Mo';
    const RANGE = 'Sheet1';
    const CLIENT_ID = '559859685690-vpt1u03eg2su86qm475358tn4parjama.apps.googleusercontent.com';
    const API_KEY = 'AIzaSyAUQWObylV_0Jx9vX7wwTCc5V7gcEv7T0s';
    const SCOPES = 'https://www.googleapis.com/auth/spreadsheets';

    let table;

    gapi.load('client', init);

    function init() {
      gapi.client.init({
        apiKey: API_KEY,
        clientId: CLIENT_ID,
        discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
        scope: SCOPES
      }).then(function () {
        // Authenticate with Google Sheets API.
        gapi.auth2.getAuthInstance().signIn().then(function () {
          // Load data for the first time.
          fetchData();
          // Set a timer to refresh data every 10 seconds.
          setInterval(fetchData, 10000);
        });
      });
    }

    function fetchData() {
      gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: SPREADSHEET_ID,
        range: RANGE
      }).then(function (response) {
        const data = response.result.values;
        if (!table) {
          // Create DataTable with the retrieved data.
          table = $('#datatable').DataTable({
            data: data,
            columns: [
               { title: '문서번호' },
		              { title: '결재완료일' },
		              { title: '문서명' },
		              { title: '지출금액' },
		              { title: '지급기한' },
		              { title: '지결제출일시' },
		              { title: '서명' },
		              { title: '확인자' },
		              { title: '확인일' },
		              { title: '비고' },
              // Add more column definitions as needed
            ],order: [[5, 'desc']]
            ,columnDefs: [{
					    "defaultContent": "-",
					    "targets": "_all"
			}]
          });

          // Enable inline editing with DataTables Editor extension.
          new $.fn.dataTable.Editor({
            table: "#datatable",
            fields: [
              { label: "확인자", name: "확인자" },
              { label: "확인일", name: "확인일" },
              { label: "비고", name: "비고" }
              // Define more editable fields as needed
            ]
          });
        } else {
          // Clear and update the DataTable with the retrieved data.
          table.clear().rows.add(data).draw();
        }
      });
    }
</script>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>광명문화재단 지출결의 제출 대장</title>
</head>
<body>
    <h1 style="text-align:center">광명문화재단 지출결의 제출 대장</h1>
    <table id="datatable" class="display" style="width:100%"></table>
</body>
</html>
