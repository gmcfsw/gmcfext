<!DOCTYPE html>
<html lang="ko">

<title>Google Sheets DataTable</title>
  <!-- Include DataTables, jQuery, and Google API Platform library -->
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.6/css/jquery.dataTables.min.css">
</head>
<body>
  <table id="datatable" class="display" style="width:100%"></table>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.11.6/js/jquery.dataTables.min.js"></script>
  <script src="https://apis.google.com/js/platform.js" async defer></script>

<script>
// Set your API key (from Google Developer Console)
    gapi.load('client', init);

    function init() {
      gapi.client.init({
        apiKey: 'AIzaSyAUQWObylV_0Jx9vX7wwTCc5V7gcEv7T0s', // Replace with your API key
      }).then(function () {
        // Authenticate with Google Sheets API.
        gapi.auth2.getAuthInstance().signIn().then(function () {
          // Load data for the first time.
          fetchData();
        });
      });
    }

    let table;

    function fetchData() {
      // Use the Google Sheets API to fetch data from your spreadsheet.
      gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: '1JzsKbWb0ei8-gmjVi14WKX8XihlPiOymBaFG0dhD9Mo', // Replace with your Google Spreadsheet ID
        range: 'Sheet1', // Adjust to the appropriate sheet and range
      }).then(function (response) {
        const data = response.result.values;

        if (!table) {
          // Create DataTable with the retrieved data.
          table = $('#datatable').DataTable({
            data: data,
            columns: data[0].map(column => ({ title: column })),
            "pageLength": 10 // Set the number of rows per page
          });

          // Enable inline editing with DataTables Editor extension.
          new $.fn.dataTable.Editor({
            table: "#datatable",
            fields: data[0].map(column => ({ label: column, name: column })),
          });
        } else {
          // Clear and update the DataTable with the retrieved data.
          table.clear().rows.add(data).draw();
        }
      });
    }

    // Fetch data every 10 seconds
    fetchData();
    setInterval(fetchData, 10000); // 10 seconds
</script>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>광명문화재단 지출결의 제출 대장</title>
</head>
<body>
    <h1 style="text-align:center">광명문화재단 지출결의 제출 대장</h1>
    <table id="datatable" class="display" style="width:100%"></table>
</body>
</html>
